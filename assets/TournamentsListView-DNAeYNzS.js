import{u as Q,j as h,o as W,k as G,c as i,a as f,b as o,d as x,w as a,r as n,l as V,e as g,h as I,f as s,g as c,t as v,F as J,i as K}from"./index-D-xIhes9.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={key:0,class:"text-center pa-10"},Z={key:2,class:"text-center text-grey pa-10"},$={key:3},ee={class:"text-h4 font-weight-bold"},te={class:"text-subtitle-1 mt-1"},w=10,oe={__name:"TournamentsListView",setup(ne){const r=Q(),u=h(""),d=h(null),y=h(1);W(()=>{r.tournamentsList.length===0&&r.fetchAllTournaments()}),G([u,d],()=>{y.value=1});const m=i(()=>u.value||d.value?null:r.currentTournament),_=i(()=>{const t=r.currentTournament?.status;return t==="live"?{text:"LIVE",icon:"mdi-broadcast",color:"primary",variant:"tonal",chipColor:"primary"}:t==="upcoming"?{text:"СКОРО",icon:"mdi-calendar-clock",color:"secondary",variant:"tonal",chipColor:"secondary"}:t==="recent"?{text:"НЕДАВНО ЗАВЕРШИЛСЯ",icon:"mdi-history",color:void 0,variant:"elevated",chipColor:"primary"}:{text:"Последний турнир",icon:"mdi-new-box",color:void 0,variant:"elevated",chipColor:"primary"}}),P=i(()=>{if(!r.tournamentsList)return[];const t=new Set(r.tournamentsList.map(e=>e.start_date.substring(0,4)));return Array.from(t).sort((e,p)=>p-e)}),z=i(()=>r.tournamentsList),L=i(()=>{if(!r.tournamentsList)return[];let t=[...z.value];if(d.value&&(t=t.filter(e=>e.start_date.startsWith(d.value))),u.value){const e=u.value.toLowerCase();t=t.filter(p=>p.name.toLowerCase().includes(e))}return t}),k=i(()=>{const t=L.value;return m.value?t.filter(e=>e.id!==m.value.id):t}),T=i(()=>Math.ceil(k.value.length/w)),B=i(()=>{const t=(y.value-1)*w,e=t+w;return k.value.slice(t,e)});return(t,e)=>{const p=n("v-toolbar-title"),C=n("v-spacer"),N=n("v-text-field"),S=n("v-select"),U=n("v-toolbar"),F=n("v-card"),A=n("v-progress-circular"),E=n("v-alert"),b=n("v-icon"),M=n("v-chip"),O=n("v-card-text"),Y=n("v-list-item-title"),j=n("v-list-item-subtitle"),q=n("v-list-item"),D=n("v-list"),H=n("v-pagination");return s(),f("div",null,[o(F,{class:"mb-6",flat:"",border:""},{default:a(()=>[o(U,{flat:"",color:"transparent"},{default:a(()=>[o(p,{class:"mx-2"},{default:a(()=>[...e[3]||(e[3]=[c("Все турниры",-1)])]),_:1}),o(C),o(N,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=l=>u.value=l),label:"Поиск по названию...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":"",clearable:"",class:"search-field"},null,8,["modelValue"]),o(S,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=l=>d.value=l),items:P.value,label:"Год",variant:"outlined",density:"compact","hide-details":"",clearable:"",class:"year-select"},null,8,["modelValue","items"])]),_:1})]),_:1}),V(r).isLoadingList?(s(),f("div",X,[o(A,{indeterminate:"",color:"primary",size:"64"})])):V(r).error?(s(),x(E,{key:1,type:"error",prominent:""},{default:a(()=>[c(" Не удалось загрузить список турниров: "+v(V(r).error),1)]),_:1})):L.value.length===0?(s(),f("div",Z,[o(b,{size:"x-large"},{default:a(()=>[...e[4]||(e[4]=[c("mdi-database-off-outline",-1)])]),_:1}),e[5]||(e[5]=g("div",{class:"mt-4 text-h6"},"Турниры не найдены",-1)),e[6]||(e[6]=g("div",{class:"mt-1"},"По вашему запросу ничего не найдено. Попробуйте изменить фильтры.",-1))])):(s(),f("div",$,[m.value?(s(),x(F,{key:0,class:"mb-8 hero-card",to:{name:"Overview",params:{tournamentId:m.value.id}},variant:_.value.variant,color:_.value.color},{default:a(()=>[o(O,{class:"d-flex align-center"},{default:a(()=>[g("div",null,[o(M,{color:_.value.chipColor,label:"",class:"mb-2 font-weight-bold"},{default:a(()=>[o(b,{start:"",icon:_.value.icon},null,8,["icon"]),c(" "+v(_.value.text),1)]),_:1},8,["color"]),g("h2",ee,v(m.value.name),1),g("div",te,v(m.value.start_date),1)]),o(C),o(b,{size:"64",class:"d-none d-sm-block chevron-icon"},{default:a(()=>[...e[7]||(e[7]=[c("mdi-chevron-right",-1)])]),_:1})]),_:1})]),_:1},8,["to","variant","color"])):I("",!0),o(D,{lines:"two",class:"py-0"},{default:a(()=>[(s(!0),f(J,null,K(B.value,l=>(s(),x(q,{key:l.id,to:{name:"Overview",params:{tournamentId:l.id}},class:"list-item-card mb-2",border:"",rounded:""},{prepend:a(()=>[o(b,{color:"grey",size:"large"},{default:a(()=>[...e[8]||(e[8]=[c("mdi-trophy-variant-outline",-1)])]),_:1})]),default:a(()=>[o(Y,{class:"text-h6 font-weight-medium"},{default:a(()=>[c(v(l.name),1)]),_:2},1024),o(j,null,{default:a(()=>[c(v(l.start_date),1)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1}),T.value>1?(s(),x(H,{key:1,modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=l=>y.value=l),length:T.value,rounded:"circle",class:"mt-6"},null,8,["modelValue","length"])):I("",!0)]))])}}},le=R(oe,[["__scopeId","data-v-a4cd0f02"]]);export{le as default};
