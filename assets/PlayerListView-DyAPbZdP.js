import{u as K}from"./playerStore-D6kvFTDZ.js";import{g as O}from"./formatters-CuXF23sB.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{j as x,o as X,c as w,k as Y,a as _,b as t,d as B,w as n,r as l,l as k,e as o,h as Z,f as s,g as u,F,i as N,t as v}from"./index-BFxfVSnb.js";const $={key:0},ee={key:2,class:"text-center text-grey pa-10"},te={key:3},ne={class:"text-white font-weight-bold"},ae={class:"flex-grow-1"},le={class:"font-weight-bold text-subtitle-1"},oe={class:"text-caption text-medium-emphasis"},se={class:"d-flex justify-space-around text-center pa-3 text-caption"},re={class:"font-weight-bold text-body-1"},ie={class:"font-weight-bold text-body-1"},C=12,de={__name:"PlayerListView",setup(ue){const r=K(),y=x(""),p=x(null),f=x("name"),V=x(1),c=x([1e3,3e3]);X(()=>{r.fetchAllPlayers()});const S=w(()=>{if(!r.playerList)return[];const m=new Set(r.playerList.map(e=>e.federation).filter(Boolean));return Array.from(m).sort()}),L=w(()=>r.playerList?r.playerList.filter(e=>{const i=e.canonical_name.toLowerCase().includes(y.value?.toLowerCase()||""),P=!p.value||e.federation===p.value,g=e.latest_rating||0,d=g===0?c.value[0]===1e3:g>=c.value[0]&&g<=c.value[1];return i&&P&&d}).sort((e,i)=>f.value==="rating"?(i.latest_rating||0)-(e.latest_rating||0):f.value==="tournaments"?(i.tournament_count||0)-(e.tournament_count||0):e.canonical_name.localeCompare(i.canonical_name)):[]);Y([y,p,f,c],()=>{V.value=1});const M=w(()=>Math.ceil(L.value.length/C)),A=w(()=>{const m=(V.value-1)*C,e=m+C;return L.value.slice(m,e)});return(m,e)=>{const i=l("v-icon"),P=l("v-expansion-panel-title"),g=l("v-text-field"),d=l("v-col"),I=l("v-select"),j=l("v-range-slider"),b=l("v-row"),h=l("v-btn"),z=l("v-btn-toggle"),D=l("v-expansion-panel-text"),E=l("v-expansion-panel"),G=l("v-expansion-panels"),U=l("v-card"),Q=l("v-skeleton-loader"),R=l("v-alert"),T=l("v-avatar"),q=l("v-card-text"),H=l("v-divider"),J=l("v-pagination");return s(),_("div",null,[t(U,{class:"mb-6"},{default:n(()=>[t(G,{variant:"accordion"},{default:n(()=>[t(E,{elevation:"0"},{default:n(()=>[t(P,null,{default:n(()=>[t(i,{start:""},{default:n(()=>[...e[5]||(e[5]=[u("mdi-filter-variant",-1)])]),_:1}),e[6]||(e[6]=u(" Фильтры и сортировка ",-1))]),_:1}),t(D,{class:"pt-4"},{default:n(()=>[t(b,{align:"center",dense:""},{default:n(()=>[t(d,{cols:"12",md:"4"},{default:n(()=>[t(g,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=a=>y.value=a),label:"Поиск по имени...","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:"",density:"compact"},null,8,["modelValue"])]),_:1}),t(d,{cols:"12",sm:"6",md:"3"},{default:n(()=>[t(I,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=a=>p.value=a),items:S.value,label:"Федерация","hide-details":"",clearable:"",density:"compact"},null,8,["modelValue","items"])]),_:1}),t(d,{cols:"12",sm:"6",md:"5"},{default:n(()=>[t(j,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=a=>c.value=a),min:1e3,max:3e3,label:"Рейтинг",step:50,"thumb-label":"always","hide-details":"",class:"pt-5"},null,8,["modelValue"])]),_:1})]),_:1}),t(b,{dense:"",class:"mt-4"},{default:n(()=>[t(d,{class:"d-flex align-center flex-wrap"},{default:n(()=>[e[10]||(e[10]=o("span",{class:"text-caption text-medium-emphasis mr-4"},"Сортировать по:",-1)),t(z,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=a=>f.value=a),color:"primary",variant:"outlined",mandatory:"",density:"compact"},{default:n(()=>[t(h,{value:"name"},{default:n(()=>[...e[7]||(e[7]=[u("Имени",-1)])]),_:1}),t(h,{value:"rating"},{default:n(()=>[...e[8]||(e[8]=[u("Рейтингу",-1)])]),_:1}),t(h,{value:"tournaments"},{default:n(()=>[...e[9]||(e[9]=[u("Опыту",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),k(r).isLoadingList?(s(),_("div",$,[t(b,null,{default:n(()=>[(s(),_(F,null,N(12,a=>t(d,{key:a,cols:"12",sm:"6",md:"4"},{default:n(()=>[t(Q,{type:"card"})]),_:1})),64))]),_:1})])):k(r).errorList?(s(),B(R,{key:1,type:"error",prominent:""},{default:n(()=>[u(" Не удалось загрузить список игроков: "+v(k(r).errorList),1)]),_:1})):L.value.length===0?(s(),_("div",ee,[t(i,{size:"x-large"},{default:n(()=>[...e[11]||(e[11]=[u("mdi-account-search-outline",-1)])]),_:1}),e[12]||(e[12]=o("div",{class:"mt-4 text-h6"},"Игроки не найдены",-1)),e[13]||(e[13]=o("div",{class:"mt-1"},"По вашему запросу ничего не найдено. Попробуйте изменить фильтры.",-1))])):(s(),_("div",te,[t(b,null,{default:n(()=>[(s(!0),_(F,null,N(A.value,a=>(s(),B(d,{key:a.id,cols:"12",sm:"6",md:"4"},{default:n(()=>[t(U,{class:"player-card h-100",to:{name:"GlobalPlayer",params:{playerId:a.id}}},{default:n(()=>[t(q,{class:"d-flex align-center"},{default:n(()=>[t(T,{color:"primary",size:"48",class:"mr-4"},{default:n(()=>[o("span",ne,v(k(O)(a.canonical_name)),1)]),_:2},1024),o("div",ae,[o("div",le,v(a.canonical_name),1),o("div",oe,v(a.federation),1)])]),_:2},1024),t(H),o("div",se,[o("div",null,[o("div",re,v(a.latest_rating||"–"),1),e[14]||(e[14]=o("div",null,"Рейтинг",-1))]),o("div",null,[o("div",ie,v(a.tournament_count),1),e[15]||(e[15]=o("div",null,"Турниров",-1))])])]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1}),M.value>1?(s(),B(J,{key:0,modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=a=>V.value=a),length:M.value,rounded:"circle",class:"mt-8"},null,8,["modelValue","length"])):Z("",!0)]))])}}},pe=W(de,[["__scopeId","data-v-36c14608"]]);export{pe as default};
