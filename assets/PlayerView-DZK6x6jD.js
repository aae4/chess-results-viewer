import{u as lt,m as st,r as nt,c as h,w as ot,a as _,d as p,g as u,b as l,f as i,e,s as at,j as d,i as g,v as y,h as s,t as o,k as r,F as U,l as F,A as it}from"./index-CAgBBP7l.js";import{g as rt,d as dt,b as G}from"./formatters-D4D2rNmP.js";import{a as ut}from"./statisticsCalculator-Bi0iwbvt.js";import{_ as ct}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chess-f0FuLRjZ.js";const vt={key:0,class:"text-center pa-10"},mt={key:1},_t={class:"text-body-1 text-medium-emphasis"},pt={class:"d-flex justify-space-around text-center pa-4"},ft={key:1},gt={class:"stat-item"},yt={class:"text-subtitle-1 font-weight-medium"},xt={class:"stat-item"},ht={class:"text-subtitle-1 font-weight-medium"},bt={class:"stat-item"},wt={class:"d-flex align-center mb-3"},kt={style:{width:"80px"}},St={class:"d-flex align-center"},Ct={style:{width:"80px"}},At={key:0},Ut={class:"d-flex align-center w-100"},It={class:"round-indicator text-center"},Vt={class:"font-weight-medium"},Pt={class:"flex-grow-1"},Gt={class:"d-flex align-center"},zt={class:"font-weight-bold"},Dt={class:"text-body-2 text-medium-emphasis ml-5"},Nt={class:"ml-auto d-flex align-center"},Bt={__name:"PlayerView",props:{tournamentId:{type:[String,Number],required:!0},playerId:{type:[String,Number],required:!0}},setup(L){const I=L,x=lt(),z=at(),c=st(),S=nt("overview"),v=h(()=>x.activePlayer),b=h(()=>x.activePlayerGames);ot(()=>I.playerId,n=>{n&&I.tournamentId&&x.fetchPlayerData(n,I.tournamentId)},{immediate:!0});const $=()=>z.back(),E=n=>{n.pgn_moves&&z.push({name:"Game",params:{gameId:n.id}})},H=n=>{if(!V(n))return"grey-lighten-1";const t=G(n.result,n.color);return t==="1"?"success":t==="0"?"error":"grey-darken-1"},J=n=>{if(!V(n))return"Не сыграна";const t=G(n.result,n.color);return t==="1"?"Победа":t==="0"?"Поражение":"Ничья"},D=h(()=>v.value?.rating_change||0),K=h(()=>{const n=D.value;return n>0?`+${n}`:n||0}),M=h(()=>{const n=D.value;return n>0?"text-success":n<0?"text-error":""}),m=h(()=>ut({playerGames:x.activePlayerGames,ecoDatabase:x.ecoDatabase})),V=n=>{const t=G(n.result,n.color);return t==="1"||t==="0"||t==="½"};return(n,t)=>{const O=i("v-progress-circular"),Q=i("v-btn"),W=i("v-avatar"),C=i("v-card-text"),w=i("v-divider"),k=i("v-card"),N=i("v-tab"),X=i("v-tabs"),f=i("v-icon"),P=i("v-card-title"),B=i("v-progress-linear"),Y=i("v-list-item-title"),Z=i("v-list-item-subtitle"),T=i("v-chip"),R=i("v-list-item"),j=i("v-list"),q=i("v-col"),tt=i("v-row"),et=i("v-alert");return d(),_("div",null,[u(x).isLoadingDetails&&!v.value?(d(),_("div",vt,[l(O,{indeterminate:"",color:"primary",size:"64"})])):v.value?(d(),_("div",mt,[l(tt,null,{default:e(()=>[l(q,{cols:"12",md:"4",class:y({"sticky-column":u(c).mdAndUp.value})},{default:e(()=>[l(k,{class:"mb-6"},{default:e(()=>[l(C,{class:"d-flex align-center"},{default:e(()=>[u(c).mdAndUp.value?(d(),p(Q,{key:0,icon:"mdi-arrow-left",variant:"text",onClick:$,class:"mr-4"})):g("",!0),l(W,{color:"primary",size:u(c).mdAndUp.value?56:64,class:"mr-4"},{default:e(()=>[s("span",{class:y([u(c).mdAndUp.value?"text-h5":"text-h4","font-weight-light"])},o(u(rt)(v.value.canonical_name)),3)]),_:1},8,["size"]),s("div",null,[s("h1",{class:y([u(c).mdAndUp.value?"text-h6":"text-h5","font-weight-bold"])},o(v.value.canonical_name),3),s("div",_t,o(v.value.club_city||v.value.federation),1)])]),_:1}),l(w),s("div",pt,[s("div",null,[t[1]||(t[1]=s("div",{class:"text-caption"},"Место",-1)),s("div",{class:y([u(c).mdAndUp.value?"text-h5":"text-h4","font-weight-bold"])},o(v.value.final_rank||"-"),3)]),s("div",null,[t[2]||(t[2]=s("div",{class:"text-caption"},"Очки",-1)),s("div",{class:y([u(c).mdAndUp.value?"text-h5":"text-h4","font-weight-bold"])},o(v.value.score||"-"),3)])])]),_:1}),u(c).mdAndUp.value?g("",!0):(d(),p(X,{key:0,modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=a=>S.value=a),color:"primary",grow:"",class:"mb-6"},{default:e(()=>[l(N,{value:"overview"},{default:e(()=>[...t[3]||(t[3]=[r("Обзор",-1)])]),_:1}),l(N,{value:"games"},{default:e(()=>[r("Партии ("+o(b.value.length)+")",1)]),_:1})]),_:1},8,["modelValue"])),u(c).mdAndUp.value||S.value==="overview"?(d(),_("div",ft,[l(k,{class:"mb-6"},{default:e(()=>[l(C,{class:"d-flex justify-space-around text-center"},{default:e(()=>[s("div",gt,[l(f,null,{default:e(()=>[...t[4]||(t[4]=[r("mdi-chess-king",-1)])]),_:1}),t[5]||(t[5]=s("div",{class:"text-caption"},"Рейтинг",-1)),s("div",yt,o(v.value.rating_at_tournament),1)]),s("div",xt,[l(f,null,{default:e(()=>[...t[6]||(t[6]=[r("mdi-finance",-1)])]),_:1}),t[7]||(t[7]=s("div",{class:"text-caption"},"Перфоманс",-1)),s("div",ht,o(v.value.performance_rating||"-"),1)]),s("div",bt,[l(f,null,{default:e(()=>[...t[8]||(t[8]=[r("mdi-arrow-up-down-bold",-1)])]),_:1}),t[9]||(t[9]=s("div",{class:"text-caption"},"+/-",-1)),s("div",{class:y(["text-subtitle-1 font-weight-medium",M.value])},o(K.value),3)])]),_:1})]),_:1}),l(k,{class:"mb-6"},{default:e(()=>[l(P,null,{default:e(()=>[...t[10]||(t[10]=[r("Результативность по цвету",-1)])]),_:1}),l(C,null,{default:e(()=>[s("div",wt,[s("div",kt,[l(f,null,{default:e(()=>[...t[11]||(t[11]=[r("mdi-circle-outline",-1)])]),_:1}),t[12]||(t[12]=r(" Белые",-1))]),l(B,{"model-value":m.value.colorStats.white.percent,color:"grey-lighten-2",height:"20",rounded:""},{default:e(()=>[s("strong",null,o(m.value.colorStats.white.points)+"/"+o(m.value.colorStats.white.games),1)]),_:1},8,["model-value"])]),s("div",St,[s("div",Ct,[l(f,null,{default:e(()=>[...t[13]||(t[13]=[r("mdi-circle",-1)])]),_:1}),t[14]||(t[14]=r(" Черные",-1))]),l(B,{"model-value":m.value.colorStats.black.percent,color:"grey-darken-2",height:"20",rounded:""},{default:e(()=>[s("strong",null,o(m.value.colorStats.black.points)+"/"+o(m.value.colorStats.black.games),1)]),_:1},8,["model-value"])])]),_:1})]),_:1}),l(k,null,{default:e(()=>[l(P,null,{default:e(()=>[...t[15]||(t[15]=[r("Дебютный репертуар",-1)])]),_:1}),m.value.openingStats.length>0?(d(),_("div",At,[l(j,{lines:"two",class:"py-0"},{default:e(()=>[(d(!0),_(U,null,F(m.value.openingStats,(a,A)=>(d(),_(U,{key:a.name},[l(R,null,{append:e(()=>[l(T,{label:"",variant:"tonal",class:"font-weight-bold"},{default:e(()=>[r(o(a.points)+"/"+o(a.count),1)]),_:2},1024)]),default:e(()=>[l(Y,{class:"font-weight-medium"},{default:e(()=>[r(o(a.name),1)]),_:2},1024),l(Z,null,{default:e(()=>[r(o(a.eco)+" · "+o(a.count)+" "+o(a.count>1?"партии":"партия"),1)]),_:2},1024)]),_:2},1024),A<m.value.openingStats.length-1?(d(),p(w,{key:0})):g("",!0)],64))),128))]),_:1})])):(d(),p(C,{key:1,class:"text-center text-grey"},{default:e(()=>[...t[16]||(t[16]=[r("Нет данных.",-1)])]),_:1}))]),_:1})])):g("",!0)]),_:1},8,["class"]),u(c).mdAndUp.value||S.value==="games"?(d(),p(q,{key:0,cols:"12",md:"8"},{default:e(()=>[l(k,null,{default:e(()=>[l(P,null,{default:e(()=>[r("Партии ("+o(b.value.length)+")",1)]),_:1}),l(w),l(j,{class:"py-0"},{default:e(()=>[(d(!0),_(U,null,F(b.value,(a,A)=>(d(),_(U,{key:a.game_id},[l(R,{class:y(["game-list-item",{"not-played":!V(a)}]),onClick:Tt=>E(a),disabled:!a.pgn_moves,lines:"two"},{default:e(()=>[s("div",Ut,[s("div",It,[t[17]||(t[17]=s("div",{class:"text-caption"},"Тур",-1)),s("div",Vt,o(a.round),1)]),s("div",Pt,[s("div",Gt,[l(f,{size:"x-small",icon:u(dt)(a.color),class:"mr-2"},null,8,["icon"]),s("span",zt,"vs "+o(a.opponent_name),1)]),s("div",Dt,"("+o(a.opponent_rating||"-")+")",1)]),s("div",Nt,[l(T,{color:H(a),label:"",class:"font-weight-bold result-chip"},{default:e(()=>[r(o(J(a)),1)]),_:2},1032,["color"]),l(f,{style:it({opacity:a.pgn_moves?1:0}),class:"ml-2 text-medium-emphasis"},{default:e(()=>[...t[18]||(t[18]=[r("mdi-chevron-right",-1)])]),_:1},8,["style"])])]),A<b.value.length-1?(d(),p(w,{key:0,class:"list-divider-mobile"})):g("",!0)]),_:2},1032,["class","onClick","disabled"]),A<b.value.length-1&&u(c).mdAndUp.value?(d(),p(w,{key:0})):g("",!0)],64))),128))]),_:1})]),_:1})]),_:1})):g("",!0)]),_:1})])):(d(),p(et,{key:2,type:"warning",class:"mt-4"},{default:e(()=>[...t[19]||(t[19]=[r("Игрок не найден.",-1)])]),_:1}))])}}},$t=ct(Bt,[["__scopeId","data-v-a93ef1c1"]]);export{$t as default};
