import{u as O,m as X,j as Y,c as k,a as i,e as s,b as a,w as l,r as c,l as w,d as h,G as Z,J as ee,f as o,F as V,i as I,g as r,t as d,n as te,q as p,M as N,h as P}from"./index-B9nZb7CB.js";import{a as g}from"./formatters-C8Ln7w-r.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const le={class:"sticky-header mb-4 elevation-1"},oe={class:"d-flex align-center justify-space-between"},ne={key:0,class:"text-center pa-10"},ae={key:1,class:"text-center text-medium-emphasis pa-10"},ie={key:0},de={key:1},ce={key:2},re=["onClick"],me={class:"text-center text-medium-emphasis"},ue={class:"text-right"},_e={class:"d-flex align-center justify-end"},ve={class:"mr-3"},he=["onClick"],fe={class:"text-caption text-medium-emphasis"},pe={class:"text-center"},xe={class:"text-left"},ye={class:"d-flex align-center"},be={key:0},ke=["onClick"],we={class:"text-caption text-medium-emphasis"},ge={key:1,class:"text-medium-emphasis font-italic"},Ce={class:"text-center"},Re={key:1,class:"px-2"},ze={key:0,class:"d-flex align-center pa-3"},Ve={class:"d-flex flex-column align-center justify-center mr-4",style:{"min-width":"40px"}},Ie={class:"text-caption text-medium-emphasis mb-1"},je={class:"flex-grow-1"},Be={class:"d-flex justify-space-between align-center mb-2"},Le={class:"d-flex align-center overflow-hidden"},Te={class:"text-caption text-medium-emphasis ml-2"},$e={class:"d-flex justify-space-between align-center"},Me={class:"d-flex align-center overflow-hidden"},Ne={class:"text-caption text-medium-emphasis ml-2"},Pe={key:0,class:"ml-2 d-flex align-center"},Ae={key:1,class:"d-flex align-center pa-3 bg-grey-lighten-5"},De={class:"mr-4 text-center",style:{"min-width":"40px"}},Ge={class:"d-flex align-center"},qe={class:"text-body-2 font-weight-bold"},Fe={class:"text-caption text-medium-emphasis ml-2"},Se={__name:"RoundsView",setup(Ue){const u=O(),j=Z(),A=ee(),D=X(),f=Y(""),_=k({get(){return u.activeRound},set(n){u.activeRound=n}}),C=k(()=>{if(u.activeTournament?.rounds_count>0)return Array.from({length:u.activeTournament.rounds_count},(n,t)=>t+1);if(u.games&&u.games.length>0){const n=Math.max(...u.games.map(t=>parseInt(t.round)||0));if(n>0)return Array.from({length:n},(t,m)=>m+1)}return[1]}),B=k(()=>C.value.length>0?Math.max(...C.value):1),R=k(()=>{if(!u.games)return[];let n=u.games.filter(t=>parseInt(t.round)===_.value);if(f.value){const t=f.value.toLowerCase();n=n.filter(m=>m.white_name.toLowerCase().includes(t)||m.black_name&&m.black_name.toLowerCase().includes(t))}return n.sort((t,m)=>(parseInt(t.board)||0)-(parseInt(m.board)||0))}),G=()=>{_.value<B.value&&_.value++},q=()=>{_.value>1&&_.value--},L=n=>{n&&j.push({name:"Player",params:{tournamentId:A.params.tournamentId,playerId:n}})},T=n=>{n.pgn_moves&&j.push({name:"Game",params:{gameId:n.id}})},x=(n,t)=>{const m=g(t.result);return n==="white"&&m==="1-0"||n==="black"&&m==="0-1"},$=n=>{const t=g(n);return t==="1-0"||t==="0-1"?"success":t==="½-½"?"grey-darken-1":"default"};return(n,t)=>{const m=c("v-text-field"),z=c("v-btn"),F=c("v-list-item-title"),S=c("v-list-item"),U=c("v-list"),E=c("v-menu"),J=c("v-container"),Q=c("v-progress-circular"),v=c("v-icon"),y=c("v-chip"),W=c("v-table"),M=c("v-card"),H=c("v-col"),K=c("v-row");return o(),i("div",null,[s("div",le,[a(J,{class:"pa-2"},{default:l(()=>[a(m,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=e=>f.value=e),placeholder:"Поиск по фамилии...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":"","bg-color":"surface",class:"mb-3",rounded:"lg"},null,8,["modelValue"]),s("div",oe,[a(z,{icon:"mdi-chevron-left",variant:"text",onClick:q,disabled:_.value<=1},null,8,["disabled"]),a(E,null,{activator:l(({props:e})=>[a(z,te(e,{variant:"text",class:"text-subtitle-1 font-weight-bold","append-icon":"mdi-menu-down"}),{default:l(()=>[r(" Тур "+d(_.value),1)]),_:1},16)]),default:l(()=>[a(U,{density:"compact","max-height":"300"},{default:l(()=>[(o(!0),i(V,null,I(C.value,e=>(o(),h(S,{key:e,value:e,onClick:b=>_.value=e,active:_.value===e,color:"primary"},{default:l(()=>[a(F,null,{default:l(()=>[r("Тур "+d(e),1)]),_:2},1024)]),_:2},1032,["value","onClick","active"]))),128))]),_:1})]),_:1}),a(z,{icon:"mdi-chevron-right",variant:"text",onClick:G,disabled:_.value>=B.value},null,8,["disabled"])])]),_:1})]),w(u).isLoadingDetails?(o(),i("div",ne,[a(Q,{indeterminate:"",color:"primary",size:"64"}),t[1]||(t[1]=s("div",{class:"text-medium-emphasis mt-4"},"Загрузка пар...",-1))])):R.value.length===0?(o(),i("div",ae,[a(v,{size:"64",class:"mb-2"},{default:l(()=>[...t[2]||(t[2]=[r("mdi-chess-king",-1)])]),_:1}),f.value?(o(),i("div",ie,"Партии с таким игроком не найдены")):(o(),i("div",de,"Нет данных о партиях в этом туре"))])):(o(),i("div",ce,[w(D).mdAndUp.value?(o(),h(M,{key:0,border:"",flat:"",class:"rounded-lg mx-4"},{default:l(()=>[a(W,{class:"rounds-table",hover:""},{default:l(()=>[t[7]||(t[7]=s("thead",null,[s("tr",null,[s("th",{class:"text-center",style:{width:"10%"}},"Доска"),s("th",{class:"text-right",style:{width:"35%"}},"Белые"),s("th",{class:"text-center",style:{width:"15%"}},"Результат"),s("th",{class:"text-left",style:{width:"35%"}},"Черные"),s("th",{class:"text-center",style:{width:"5%"}})])],-1)),s("tbody",null,[(o(!0),i(V,null,I(R.value,e=>(o(),i("tr",{key:e.id,onClick:b=>T(e),class:p([{clickable:e.pgn_moves},"table-row"])},[s("td",me,d(e.board||"-"),1),s("td",ue,[s("div",_e,[s("div",ve,[s("div",{class:p(["font-weight-medium player-name-cell",{"text-primary font-weight-bold":x("white",e)}]),onClick:N(b=>L(e.white_player_id),["stop"])},d(e.white_name),11,he),s("div",fe,d(e.white_rating),1)]),a(v,{size:"small",color:"grey-lighten-1"},{default:l(()=>[...t[3]||(t[3]=[r("mdi-chess-pawn",-1)])]),_:1})])]),s("td",pe,[e.black_player_id?(o(),h(y,{key:0,color:$(e.result),variant:"tonal",label:"",class:"font-weight-bold px-4"},{default:l(()=>[r(d(w(g)(e.result)),1)]),_:2},1032,["color"])):(o(),h(y,{key:1,color:"warning",variant:"tonal",label:""},{default:l(()=>[...t[4]||(t[4]=[r("Bye",-1)])]),_:1}))]),s("td",xe,[s("div",ye,[a(v,{size:"small",color:"grey-darken-3",class:"mr-3"},{default:l(()=>[...t[5]||(t[5]=[r("mdi-chess-pawn",-1)])]),_:1}),e.black_player_id?(o(),i("div",be,[s("div",{class:p(["font-weight-medium player-name-cell",{"text-primary font-weight-bold":x("black",e)}]),onClick:N(b=>L(e.black_player_id),["stop"])},d(e.black_name),11,ke),s("div",we,d(e.black_rating),1)])):(o(),i("span",ge,"Нет пары"))])]),s("td",Ce,[e.pgn_moves?(o(),h(v,{key:0,color:"primary",class:"chevron-icon"},{default:l(()=>[...t[6]||(t[6]=[r("mdi-chevron-right",-1)])]),_:1})):P("",!0)])],10,re))),128))])]),_:1})]),_:1})):(o(),i("div",Re,[a(K,{dense:""},{default:l(()=>[(o(!0),i(V,null,I(R.value,e=>(o(),h(H,{key:e.id,cols:"12"},{default:l(()=>[a(M,{class:"mb-1 border-thin rounded-lg",flat:"",onClick:b=>T(e),ripple:!!e.pgn_moves,disabled:!e.pgn_moves&&!!e.black_player_id},{default:l(()=>[e.black_player_id?(o(),i("div",ze,[s("div",Ve,[s("div",Ie,"Доска "+d(e.board),1),a(y,{size:"small",color:$(e.result),variant:"tonal",label:"",class:"font-weight-bold"},{default:l(()=>[r(d(w(g)(e.result)),1)]),_:2},1032,["color"])]),s("div",je,[s("div",Be,[s("div",Le,[a(v,{size:"x-small",class:"mr-2 text-medium-emphasis"},{default:l(()=>[...t[8]||(t[8]=[r("mdi-circle-outline",-1)])]),_:1}),s("span",{class:p(["text-body-2 text-truncate",{"font-weight-bold text-primary":x("white",e)}])},d(e.white_name),3)]),s("span",Te,d(e.white_rating),1)]),s("div",$e,[s("div",Me,[a(v,{size:"x-small",class:"mr-2 text-medium-emphasis"},{default:l(()=>[...t[9]||(t[9]=[r("mdi-circle",-1)])]),_:1}),s("span",{class:p(["text-body-2 text-truncate",{"font-weight-bold text-primary":x("black",e)}])},d(e.black_name),3)]),s("span",Ne,d(e.black_rating),1)])]),e.pgn_moves?(o(),i("div",Pe,[a(v,{color:"primary"},{default:l(()=>[...t[10]||(t[10]=[r("mdi-chevron-right",-1)])]),_:1})])):P("",!0)])):(o(),i("div",Ae,[s("div",De,[a(y,{size:"small",color:"warning",variant:"tonal",label:""},{default:l(()=>[...t[11]||(t[11]=[r("Bye",-1)])]),_:1})]),s("div",Ge,[a(v,{size:"x-small",class:"mr-2"},{default:l(()=>[...t[12]||(t[12]=[r("mdi-circle-outline",-1)])]),_:1}),s("span",qe,d(e.white_name),1),s("span",Fe,"("+d(e.white_rating)+")",1)])]))]),_:2},1032,["onClick","ripple","disabled"])]),_:2},1024))),128))]),_:1})]))]))])}}},We=se(Se,[["__scopeId","data-v-04dd5d78"]]);export{We as default};
