import{u as oe}from"./playerStore-Bab5MA9n.js";import{g as ne}from"./formatters-C8Ln7w-r.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{m as ie,j as g,o as re,c as x,k as ue,a as _,e as o,h as C,d as y,b as t,r as n,w as l,n as de,p as me,l as h,t as u,f as s,g as i,q as ve,F as R,i as j}from"./index-B9nZb7CB.js";const ce={class:"d-flex align-center ga-2 mb-4 sticky-search"},pe={key:0,class:"d-flex flex-wrap ga-2 mb-4"},fe={class:"d-flex ga-3 align-center"},_e={key:1},ge={key:3,class:"text-center text-grey pa-10 mt-4"},xe={key:4},be={class:"text-white text-h6 font-weight-bold"},ye={class:"flex-grow-1 overflow-hidden"},ke={class:"font-weight-bold text-subtitle-1 name-clamp mb-1"},we={class:"d-flex align-center"},Ve={class:"text-caption text-medium-emphasis font-weight-medium"},Ce={class:"d-flex py-2 card-footer-bg"},he={class:"flex-grow-1 text-center border-e"},Le={class:"font-weight-bold text-body-1"},ze={class:"flex-grow-1 text-center"},Pe={class:"font-weight-bold text-body-1"},Ue={key:0,class:"text-center mt-6 mb-8"},Ae={key:1,class:"text-center mt-6 mb-8 text-caption text-medium-emphasis"},B=12,Fe={__name:"PlayerListView",setup(Be){const c=oe(),U=ie(),k=g(""),d=g(null),m=g("name"),L=g(!1),p=g(0),f=g(3e3),z=g(B),A=g(!1);re(()=>{c.fetchAllPlayers()});const T=x(()=>U.mdAndUp.value?"v-dialog":"v-bottom-sheet"),q=x(()=>U.mdAndUp.value?{maxWidth:"500"}:{inset:!0}),E=x(()=>{if(!c.playerList)return[];const r=new Set(c.playerList.map(e=>e.federation).filter(Boolean));return Array.from(r).sort()}),b=x(()=>{if(!c.playerList)return[];let r=c.playerList.filter(e=>{if(k.value&&!e.canonical_name.toLowerCase().includes(k.value.toLowerCase())||d.value&&e.federation!==d.value)return!1;const v=e.latest_rating||0;return!(v<p.value||v>f.value)});return r.sort((e,v)=>m.value==="rating"?(v.latest_rating||0)-(e.latest_rating||0):m.value==="tournaments"?(v.tournament_count||0)-(e.tournament_count||0):e.canonical_name.localeCompare(v.canonical_name)),r}),G=x(()=>b.value.slice(0,z.value)),Q=x(()=>z.value<b.value.length),W=x(()=>b.value.length-z.value),P=x(()=>{let r=0;return d.value&&r++,(p.value>0||f.value<3e3)&&r++,m.value!=="name"&&r++,r}),H=()=>{A.value=!0,setTimeout(()=>{z.value+=B,A.value=!1},300)},J=()=>{p.value=0,f.value=3e3},M=()=>{k.value="",d.value=null,p.value=0,f.value=3e3,m.value="name"},K=r=>({name:"Имя",rating:"Рейтинг",tournaments:"Опыт"})[r]||r;return ue([k,d,p,f,m],()=>{z.value=B}),(r,e)=>{const v=n("v-text-field"),F=n("v-icon"),O=n("v-badge"),w=n("v-btn"),V=n("v-chip"),X=n("v-card-title"),N=n("v-divider"),Y=n("v-chip-group"),Z=n("v-select"),$=n("v-card-text"),ee=n("v-card-actions"),S=n("v-card"),te=n("v-skeleton-loader"),D=n("v-col"),I=n("v-row"),le=n("v-alert"),ae=n("v-avatar");return s(),_("div",null,[o("div",ce,[t(v,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=a=>k.value=a),label:"Найти игрока...",placeholder:"Имя или Фамилия","prepend-inner-icon":"mdi-magnify",variant:"solo",density:"comfortable","hide-details":"","single-line":"",class:"flex-grow-1",clearable:""},null,8,["modelValue"]),t(w,{size:"large",height:"48",width:"48",variant:"tonal",color:"primary",onClick:e[1]||(e[1]=a=>L.value=!0),"aria-label":"Открыть фильтры"},{default:l(()=>[t(O,{"model-value":P.value>0,content:P.value,color:"error",floating:""},{default:l(()=>[t(F,null,{default:l(()=>[...e[11]||(e[11]=[i("mdi-tune-variant",-1)])]),_:1})]),_:1},8,["model-value","content"])]),_:1})]),P.value>0?(s(),_("div",pe,[d.value?(s(),y(V,{key:0,closable:"",color:"primary",label:"",size:"small","onClick:close":e[2]||(e[2]=a=>d.value=null)},{default:l(()=>[i(" Фед: "+u(d.value),1)]),_:1})):C("",!0),p.value>0||f.value<3e3?(s(),y(V,{key:1,closable:"",color:"primary",label:"",size:"small","onClick:close":J},{default:l(()=>[i(" Рейтинг: "+u(p.value)+" - "+u(f.value),1)]),_:1})):C("",!0),m.value!=="name"?(s(),y(V,{key:2,closable:"",color:"secondary",label:"",size:"small","onClick:close":e[3]||(e[3]=a=>m.value="name")},{default:l(()=>[i(" Сорт: "+u(K(m.value)),1)]),_:1})):C("",!0),P.value>1?(s(),y(w,{key:3,variant:"text",size:"small",color:"medium-emphasis",class:"px-1",onClick:M},{default:l(()=>[...e[12]||(e[12]=[i(" Сбросить все ",-1)])]),_:1})):C("",!0)])):C("",!0),(s(),y(me(T.value),de(q.value,{modelValue:L.value,"onUpdate:modelValue":e[10]||(e[10]=a=>L.value=a)}),{default:l(()=>[t(S,{class:ve(h(U).mdAndUp.value?"rounded-lg":"rounded-t-xl")},{default:l(()=>[t(X,{class:"d-flex justify-space-between align-center pa-4"},{default:l(()=>[e[13]||(e[13]=o("span",{class:"text-h6"},"Настройки поиска",-1)),t(w,{icon:"mdi-close",variant:"text",onClick:e[4]||(e[4]=a=>L.value=!1)})]),_:1}),t(N),t($,{class:"pa-4"},{default:l(()=>[e[18]||(e[18]=o("div",{class:"text-subtitle-2 mb-2"},"Сортировать по",-1)),t(Y,{modelValue:m.value,"onUpdate:modelValue":e[5]||(e[5]=a=>m.value=a),"selected-class":"text-primary",mandatory:"",class:"mb-4"},{default:l(()=>[t(V,{value:"name",filter:"",variant:"outlined"},{default:l(()=>[...e[14]||(e[14]=[i("Имени",-1)])]),_:1}),t(V,{value:"rating",filter:"",variant:"outlined"},{default:l(()=>[...e[15]||(e[15]=[i("Рейтингу",-1)])]),_:1}),t(V,{value:"tournaments",filter:"",variant:"outlined"},{default:l(()=>[...e[16]||(e[16]=[i("Опыту",-1)])]),_:1})]),_:1},8,["modelValue"]),t(Z,{modelValue:d.value,"onUpdate:modelValue":e[6]||(e[6]=a=>d.value=a),items:E.value,label:"Федерация",variant:"outlined",density:"comfortable",clearable:"","hide-details":"auto",class:"mb-4"},null,8,["modelValue","items"]),e[19]||(e[19]=o("div",{class:"text-subtitle-2 mb-2"},"Диапазон рейтинга",-1)),o("div",fe,[t(v,{modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=a=>p.value=a),modelModifiers:{number:!0},label:"От",type:"number",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"]),e[17]||(e[17]=o("span",{class:"text-medium-emphasis"},"–",-1)),t(v,{modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=a=>f.value=a),modelModifiers:{number:!0},label:"До",type:"number",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])])]),_:1}),t(ee,{class:"pa-4 pt-0"},{default:l(()=>[t(w,{block:"",color:"primary",variant:"flat",size:"large",onClick:e[9]||(e[9]=a=>L.value=!1)},{default:l(()=>[i(" Показать результаты ("+u(b.value.length)+") ",1)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1},16,["modelValue"])),h(c).isLoadingList&&!h(c).playerList?.length?(s(),_("div",_e,[t(I,null,{default:l(()=>[(s(),_(R,null,j(6,a=>t(D,{key:a,cols:"12",sm:"6",md:"4"},{default:l(()=>[t(te,{type:"card, text"})]),_:1})),64))]),_:1})])):h(c).errorList?(s(),y(le,{key:2,type:"error",prominent:"",class:"mt-4"},{default:l(()=>[i(" Не удалось загрузить список игроков: "+u(h(c).errorList),1)]),_:1})):b.value.length===0?(s(),_("div",ge,[t(F,{size:"64",color:"grey-lighten-1"},{default:l(()=>[...e[20]||(e[20]=[i("mdi-account-off-outline",-1)])]),_:1}),e[22]||(e[22]=o("div",{class:"mt-4 text-h6 text-medium-emphasis"},"Игроки не найдены",-1)),e[23]||(e[23]=o("div",{class:"text-body-2 text-medium-emphasis mt-1"},"Попробуйте изменить параметры поиска",-1)),t(w,{class:"mt-4",variant:"outlined",color:"primary",onClick:M},{default:l(()=>[...e[21]||(e[21]=[i(" Сбросить фильтры ",-1)])]),_:1})])):(s(),_("div",xe,[t(I,{class:"mt-1"},{default:l(()=>[(s(!0),_(R,null,j(G.value,a=>(s(),y(D,{key:a.id,cols:"12",sm:"6",md:"4"},{default:l(()=>[t(S,{class:"player-card h-100",to:{name:"GlobalPlayer",params:{playerId:a.id}},elevation:"1"},{default:l(()=>[t($,{class:"d-flex align-center py-3"},{default:l(()=>[t(ae,{color:"primary",size:"56",class:"mr-4 elevation-2"},{default:l(()=>[o("span",be,u(h(ne)(a.canonical_name)),1)]),_:2},1024),o("div",ye,[o("div",ke,u(a.canonical_name),1),o("div",we,[t(F,{size:"x-small",class:"mr-1 text-medium-emphasis"},{default:l(()=>[...e[24]||(e[24]=[i("mdi-flag-outline",-1)])]),_:1}),o("span",Ve,u(a.federation||"N/A"),1)])])]),_:2},1024),t(N),o("div",Ce,[o("div",he,[e[25]||(e[25]=o("div",{class:"text-caption text-medium-emphasis"},"Рейтинг",-1)),o("div",Le,u(a.latest_rating||"–"),1)]),o("div",ze,[e[26]||(e[26]=o("div",{class:"text-caption text-medium-emphasis"},"Турниров",-1)),o("div",Pe,u(a.tournament_count),1)])])]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1}),Q.value?(s(),_("div",Ue,[t(w,{variant:"elevated",color:"white",size:"large",class:"text-primary px-8",elevation:"2",loading:A.value,onClick:H},{default:l(()=>[i(" Показать еще ("+u(W.value)+") ",1)]),_:1},8,["loading"])])):b.value.length>0?(s(),_("div",Ae," Показаны все игроки ("+u(b.value.length)+") ",1)):C("",!0)]))])}}},De=se(Fe,[["__scopeId","data-v-bd359272"]]);export{De as default};
