import{u as nt,A as ot,j as at,c as h,k as it,a as m,d as f,l as u,b as e,r,w as l,C as rt,f as d,h as g,D as y,e as s,t as o,g as i,F as I,i as $,O as dt}from"./index-OFearDcG.js";import{g as ut,c as ct,f as G}from"./formatters-C8Ln7w-r.js";import{a as vt}from"./statisticsCalculator-BpJe-Tkt.js";import{_ as mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chess-f0FuLRjZ.js";const _t={key:0,class:"text-center pa-10"},pt={key:1},ft={class:"text-body-1 text-medium-emphasis"},gt={class:"d-flex justify-space-around text-center pa-4"},yt={key:1},xt={class:"stat-item"},bt={class:"text-subtitle-1 font-weight-medium"},ht={class:"stat-item"},wt={class:"text-subtitle-1 font-weight-medium"},kt={class:"stat-item"},Ct={class:"d-flex align-center mb-3"},St={style:{width:"80px"}},At={class:"d-flex align-center"},Ut={style:{width:"80px"}},It={key:0},Pt={class:"d-flex align-center w-100"},Vt={class:"round-indicator text-center"},Gt={class:"font-weight-medium"},Bt={key:0,class:"flex-grow-1 d-flex align-center text-medium-emphasis"},Dt={key:1,class:"flex-grow-1"},zt={class:"d-flex align-center"},Nt={class:"font-weight-bold"},Tt={class:"text-body-2 text-medium-emphasis ml-5"},Rt={class:"ml-auto d-flex align-center"},jt={__name:"PlayerView",props:{tournamentId:{type:[String,Number],required:!0},playerId:{type:[String,Number],required:!0}},setup(E){const C=E,x=nt(),B=rt(),c=ot(),S=at("overview"),v=h(()=>x.activePlayer),w=h(()=>x.activePlayerGames);it(()=>C.playerId,n=>{n&&C.tournamentId&&x.fetchPlayerData(n,C.tournamentId)},{immediate:!0});const O=()=>B.back(),H=n=>{n.pgn_moves&&B.push({name:"Game",params:{gameId:n.id}})},P=n=>n.opponent_name==="Пропуск тура",J=n=>{if(P(n))return"success";if(!z(n))return"grey-lighten-1";const t=G(n.result,n.color);return t==="1"?"success":t==="0"?"error":"grey-darken-1"},K=n=>{if(P(n))return"+1";const t=G(n.result,n.color);return t==="1"?"Победа":t==="0"?"Поражение":t==="½"?"Ничья":t==="+--"?"Тех. победа":t==="--+"?"Тех. поражение":"Не сыграна"},D=h(()=>v.value?.rating_change||0),M=h(()=>{const n=D.value;return n>0?`+${n}`:n||0}),Q=h(()=>{const n=D.value;return n>0?"text-success":n<0?"text-error":""}),_=h(()=>vt({playerGames:x.activePlayerGames,ecoDatabase:x.ecoDatabase})),z=n=>{const t=G(n.result,n.color);return t==="1"||t==="0"||t==="½"};return(n,t)=>{const W=r("v-progress-circular"),N=r("v-btn"),X=r("v-avatar"),A=r("v-card-text"),b=r("v-divider"),Y=r("v-card-actions"),k=r("v-card"),T=r("v-tab"),Z=r("v-tabs"),p=r("v-icon"),V=r("v-card-title"),R=r("v-progress-linear"),tt=r("v-list-item-title"),et=r("v-list-item-subtitle"),j=r("v-chip"),q=r("v-list-item"),F=r("v-list"),L=r("v-col"),lt=r("v-row"),st=r("v-alert");return d(),m("div",null,[u(x).isLoadingDetails&&!v.value?(d(),m("div",_t,[e(W,{indeterminate:"",color:"primary",size:"64"})])):v.value?(d(),m("div",pt,[e(lt,null,{default:l(()=>[e(L,{cols:"12",md:"4",class:y({"sticky-column":u(c).mdAndUp.value})},{default:l(()=>[e(k,{class:"mb-6"},{default:l(()=>[e(A,{class:"d-flex align-center"},{default:l(()=>[u(c).mdAndUp.value?(d(),f(N,{key:0,icon:"mdi-arrow-left",variant:"text",onClick:O,class:"mr-4"})):g("",!0),e(X,{color:"primary",size:u(c).mdAndUp.value?56:64,class:"mr-4"},{default:l(()=>[s("span",{class:y([u(c).mdAndUp.value?"text-h5":"text-h4","font-weight-light"])},o(u(ut)(v.value.canonical_name)),3)]),_:1},8,["size"]),s("div",null,[s("h1",{class:y([u(c).mdAndUp.value?"text-h6":"text-h5","font-weight-bold"])},o(v.value.canonical_name),3),s("div",ft,o(v.value.club_city||v.value.federation),1)])]),_:1}),e(b),s("div",gt,[s("div",null,[t[1]||(t[1]=s("div",{class:"text-caption"},"Место",-1)),s("div",{class:y([u(c).mdAndUp.value?"text-h5":"text-h4","font-weight-bold"])},o(v.value.final_rank||"-"),3)]),s("div",null,[t[2]||(t[2]=s("div",{class:"text-caption"},"Очки",-1)),s("div",{class:y([u(c).mdAndUp.value?"text-h5":"text-h4","font-weight-bold"])},o(v.value.score||"-"),3)])]),e(b),e(Y,null,{default:l(()=>[e(N,{to:{name:"GlobalPlayer",params:{playerId:C.playerId}},color:"primary",variant:"text",block:"","append-icon":"mdi-arrow-right"},{default:l(()=>[...t[3]||(t[3]=[i(" Смотреть полную карьеру ",-1)])]),_:1},8,["to"])]),_:1})]),_:1}),u(c).mdAndUp.value?g("",!0):(d(),f(Z,{key:0,modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=a=>S.value=a),color:"primary",grow:"",class:"mb-6"},{default:l(()=>[e(T,{value:"overview"},{default:l(()=>[...t[4]||(t[4]=[i("Обзор",-1)])]),_:1}),e(T,{value:"games"},{default:l(()=>[i("Партии ("+o(w.value.length)+")",1)]),_:1})]),_:1},8,["modelValue"])),u(c).mdAndUp.value||S.value==="overview"?(d(),m("div",yt,[e(k,{class:"mb-6"},{default:l(()=>[e(A,{class:"d-flex justify-space-around text-center"},{default:l(()=>[s("div",xt,[e(p,null,{default:l(()=>[...t[5]||(t[5]=[i("mdi-chess-king",-1)])]),_:1}),t[6]||(t[6]=s("div",{class:"text-caption"},"Рейтинг",-1)),s("div",bt,o(v.value.rating_at_tournament),1)]),s("div",ht,[e(p,null,{default:l(()=>[...t[7]||(t[7]=[i("mdi-finance",-1)])]),_:1}),t[8]||(t[8]=s("div",{class:"text-caption"},"Перфоманс",-1)),s("div",wt,o(v.value.performance_rating||"-"),1)]),s("div",kt,[e(p,null,{default:l(()=>[...t[9]||(t[9]=[i("mdi-arrow-up-down-bold",-1)])]),_:1}),t[10]||(t[10]=s("div",{class:"text-caption"},"+/-",-1)),s("div",{class:y(["text-subtitle-1 font-weight-medium",Q.value])},o(M.value),3)])]),_:1})]),_:1}),e(k,{class:"mb-6"},{default:l(()=>[e(V,null,{default:l(()=>[...t[11]||(t[11]=[i("Результативность по цвету",-1)])]),_:1}),e(A,null,{default:l(()=>[s("div",Ct,[s("div",St,[e(p,null,{default:l(()=>[...t[12]||(t[12]=[i("mdi-circle-outline",-1)])]),_:1}),t[13]||(t[13]=i(" Белые",-1))]),e(R,{"model-value":_.value.colorStats.white.percent,color:"grey-lighten-2",height:"20",rounded:""},{default:l(()=>[s("strong",null,o(_.value.colorStats.white.points)+"/"+o(_.value.colorStats.white.games),1)]),_:1},8,["model-value"])]),s("div",At,[s("div",Ut,[e(p,null,{default:l(()=>[...t[14]||(t[14]=[i("mdi-circle",-1)])]),_:1}),t[15]||(t[15]=i(" Черные",-1))]),e(R,{"model-value":_.value.colorStats.black.percent,color:"grey-darken-2",height:"20",rounded:""},{default:l(()=>[s("strong",null,o(_.value.colorStats.black.points)+"/"+o(_.value.colorStats.black.games),1)]),_:1},8,["model-value"])])]),_:1})]),_:1}),e(k,null,{default:l(()=>[e(V,null,{default:l(()=>[...t[16]||(t[16]=[i("Дебютный репертуар",-1)])]),_:1}),_.value.openingStats.length>0?(d(),m("div",It,[e(F,{lines:"two",class:"py-0"},{default:l(()=>[(d(!0),m(I,null,$(_.value.openingStats,(a,U)=>(d(),m(I,{key:a.name},[e(q,null,{append:l(()=>[e(j,{label:"",variant:"tonal",class:"font-weight-bold"},{default:l(()=>[i(o(a.points)+"/"+o(a.count),1)]),_:2},1024)]),default:l(()=>[e(tt,{class:"font-weight-medium"},{default:l(()=>[i(o(a.name),1)]),_:2},1024),e(et,null,{default:l(()=>[i(o(a.eco)+" · "+o(a.count)+" "+o(a.count>1?"партии":"партия"),1)]),_:2},1024)]),_:2},1024),U<_.value.openingStats.length-1?(d(),f(b,{key:0})):g("",!0)],64))),128))]),_:1})])):(d(),f(A,{key:1,class:"text-center text-grey"},{default:l(()=>[...t[17]||(t[17]=[i("Нет данных.",-1)])]),_:1}))]),_:1})])):g("",!0)]),_:1},8,["class"]),u(c).mdAndUp.value||S.value==="games"?(d(),f(L,{key:0,cols:"12",md:"8"},{default:l(()=>[e(k,null,{default:l(()=>[e(V,null,{default:l(()=>[i("Партии ("+o(w.value.length)+")",1)]),_:1}),e(b),e(F,{class:"py-0"},{default:l(()=>[(d(!0),m(I,null,$(w.value,(a,U)=>(d(),m(I,{key:a.game_id},[e(q,{class:y(["game-list-item",{"not-played":!z(a)}]),onClick:qt=>H(a),disabled:!a.pgn_moves,lines:"two"},{default:l(()=>[s("div",Pt,[s("div",Vt,[t[18]||(t[18]=s("div",{class:"text-caption"},"Тур",-1)),s("div",Gt,o(a.round),1)]),P(a)?(d(),m("div",Bt,[e(p,{class:"mr-2"},{default:l(()=>[...t[19]||(t[19]=[i("mdi-skip-next-circle-outline",-1)])]),_:1}),t[20]||(t[20]=s("span",{class:"font-weight-bold"},"Пропуск тура (Bye)",-1))])):(d(),m("div",Dt,[s("div",zt,[e(p,{size:"x-small",icon:u(ct)(a.color),class:"mr-2"},null,8,["icon"]),s("span",Nt,"vs "+o(a.opponent_name),1)]),s("div",Tt,"("+o(a.opponent_rating||"-")+")",1)])),s("div",Rt,[e(j,{color:J(a),variant:a.is_technical===1?"outlined":"tonal",label:"",class:"font-weight-bold result-chip"},{default:l(()=>[i(o(K(a)),1)]),_:2},1032,["color","variant"]),e(p,{style:dt({opacity:a.pgn_moves?1:0}),class:"ml-2 text-medium-emphasis"},{default:l(()=>[...t[21]||(t[21]=[i("mdi-chevron-right",-1)])]),_:1},8,["style"])])]),U<w.value.length-1?(d(),f(b,{key:0,class:"list-divider-mobile"})):g("",!0)]),_:2},1032,["class","onClick","disabled"]),U<w.value.length-1&&u(c).mdAndUp.value?(d(),f(b,{key:0})):g("",!0)],64))),128))]),_:1})]),_:1})]),_:1})):g("",!0)]),_:1})])):(d(),f(st,{key:2,type:"warning",class:"mt-4"},{default:l(()=>[...t[22]||(t[22]=[i("Игрок не найден.",-1)])]),_:1}))])}}},Ht=mt(jt,[["__scopeId","data-v-b32922c4"]]);export{Ht as default};
